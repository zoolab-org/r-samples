
# run it with: R -f draw_cov.r
setwd(sprintf("%s/r-samples/asiajcis19", Sys.getenv("HOME")))

pdf_on <- function(fn, output = TRUE) {
    if(output == FALSE) { return(); }
    pdf(fn, width=4, height=4, fonts=c("sans", "mono"), onefile=TRUE)
}

pdf_off <- function(output = TRUE) {
    if(output == FALSE) { return(); }
    dev.off();
}

M <- c(22.000000,22.000000,23.000000,23.500000,23.800000,26.833333,26.571429,27.750000,28.222222,29.600000,29.181818,30.666667,
    31.846154,37.142857,41.000000,41.062500,41.352941,41.055556,40.315789,40.400000,40.809524,42.363636,47.043478,51.166667,
    50.760000,50.500000,49.555556,49.357143,48.517241,47.733333)

T <-c(148.000000,112.000000,95.000000,82.250000,74.600000,68.833333,72.857143,71.125000,69.777778,68.700000,64.727273,68.083333,
    68.692308,74.357143,72.200000,71.125000,70.117647,69.222222,74.736842,73.300000,72.000000,73.863636,77.869565,76.583333,
    74.960000,78.461538,80.555556,80.392857,80.827586,81.133333)

R <-c(146.000000,156.000000,124.333333,103.250000,106.000000,96.000000,85.857143,79.625000,73.222222,69.500000,67.818182,
    76.333333,74.076923,76.142857,78.466667,80.375000,81.941176,86.833333,84.473684,88.750000,89.619048,93.272727,96.608696,
    97.708333,98.080000,100.230769,102.444444,104.428571,106.448276,108.466667)

F <-c(22.000000,22.000000,23.000000,23.500000,27.200000,26.833333,28.142857,27.750000,28.222222,29.600000,30.909091,32.250000,
    37.076923,40.785714,41.133333,40.812500,40.000000,40.111111,43.631579,46.800000,46.904762,48.181818,52.521739,53.500000,
    53.040000,54.961538,58.481481,57.214286,56.103448,55.266667)

pdf_on("./plot/avg_gif2png_hamming_dist_tracebits.pdf");

plot(M,type = "l", col = "red",lty=1, xlab = "Seeds fuzzed", ylab = "Average Number of Trace Bits of All Seeds",ylim=c(0,120),
   main = "Tcpdump")
lines(T, type = "l", col = "blue",lty=3)
lines(R, type = "l", col = "magenta",lty=2)
lines(F, type = "l", col = "black",lty=4)
legend(18,35, legend=c("AFL","1.5","0.125","AFLFast"),
       col=c("red","blue","magenta","black"), lty=c(1,3,2,4), cex=0.65)
pdf_off();
